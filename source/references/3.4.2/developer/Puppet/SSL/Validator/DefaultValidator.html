<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Puppet::SSL::Validator::DefaultValidator
  
    &mdash; Documentation by YARD 0.8.7.3
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../';
  framesUrl = "../../../frames.html#!" + escape(window.location.href);
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (D)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Puppet.html" title="Puppet (module)">Puppet</a></span></span> &raquo; <span class='title'><span class='object_link'>SSL</span></span> &raquo; <span class='title'><span class='object_link'><a href="../Validator.html" title="Puppet::SSL::Validator (class)">Validator</a></span></span>
     &raquo; 
    <span class="title">DefaultValidator</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Puppet::SSL::Validator::DefaultValidator
  
  
  <span class="private note title">Private</span>
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'>Object</span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'>Object</span></li>
          
            <li class="next">Puppet::SSL::Validator::DefaultValidator</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/puppet/ssl/validator/default_validator.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This class is part of a private API.</strong>
  You should avoid using this class if possible, as it may be removed or be changed in the future.
</p>
<p>Perform peer certificate verification against the known CA.
If there is no CA information known, then no verification is performed</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#call-instance_method" title="#call (instance method)">- (Boolean) <strong>call</strong>(preverify_ok, ssl_context) </a>
    

    
  </span>
  
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Performs verification of the SSL connection and collection of the certificates for use in constructing the error message if the verification failed.</p>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#has_authz_peer_cert-instance_method" title="#has_authz_peer_cert (instance method)">- (Boolean) <strong>has_authz_peer_cert</strong>(peer_certs, authz_certs) </a>
    

    
  </span>
  
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Checks if the set of peer_certs contains at least one certificate issued by a certificate listed in authz_certs.</p>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (DefaultValidator) <strong>initialize</strong>(ssl_configuration = Puppet::SSL::Configuration.new(                                         Puppet[:localcacert], {                                           :ca_chain_file =&gt; Puppet[:ssl_client_ca_chain],                                           :ca_auth_file  =&gt; Puppet[:ssl_client_ca_auth]                                         }), ssl_host = Puppet::SSL::Host.localhost) </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Creates a new DefaultValidator, optionally with an SSL Configuration and SSL Host.</p>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#reset%21-instance_method" title="#reset! (instance method)">- (Object) <strong>reset!</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Resets this validator to its initial validation state.</p>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#setup_connection-instance_method" title="#setup_connection (instance method)">- <strong>setup_connection</strong>(connection) </a>
    

    
  </span>
  
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Registers the instance's call method with the connection.</p>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#ssl_certificates_are_present%3F-instance_method" title="#ssl_certificates_are_present? (instance method)">- (Boolean) <strong>ssl_certificates_are_present?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#valid_peer%3F-instance_method" title="#valid_peer? (instance method)">- (Boolean) <strong>valid_peer?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Validates the peer certificates against the authorized certificates.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Puppet::SSL::Validator::DefaultValidator (class)">DefaultValidator</a></span></tt>) <strong>initialize</strong>(ssl_configuration = Puppet::SSL::Configuration.new(
                                        Puppet[:localcacert], {
                                          :ca_chain_file =&gt; Puppet[:ssl_client_ca_chain],
                                          :ca_auth_file  =&gt; Puppet[:ssl_client_ca_auth]
                                        }), ssl_host = Puppet::SSL::Host.localhost) &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Creates a new DefaultValidator, optionally with an SSL Configuration and SSL Host.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>(a</span>
      
      
        <span class='type'>(<tt><span class='object_link'>Puppet::SSL::Configuration</span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>default configuration) ssl_configuration the SSL configuration to use</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>(Puppet::SSL::Host.localhost)</span>
      
      
        <span class='type'>(<tt><span class='object_link'>Puppet::SSL::Host</span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the SSL host to use</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22
23
24
25
26
27
28
29
30
31</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/ssl/validator/default_validator.rb', line 20</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_initialize identifier id'>initialize</span><span class='lparen token'>(</span>
    <span class='rubyid_ssl_configuration identifier id'>ssl_configuration</span> <span class='assign token'>=</span> <span class='rubyid_Puppet constant id'>Puppet</span><span class='colon2 op'>::</span><span class='rubyid_SSL constant id'>SSL</span><span class='colon2 op'>::</span><span class='rubyid_Configuration constant id'>Configuration</span><span class='dot token'>.</span><span class='rubyid_new identifier id'>new</span><span class='lparen token'>(</span>
                                      <span class='rubyid_Puppet constant id'>Puppet</span><span class='lbrack token'>[</span><span class='symbol val'>:localcacert</span><span class='rbrack token'>]</span><span class='comma token'>,</span> <span class='lbrace token'>{</span>
                                        <span class='symbol val'>:ca_chain_file</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_Puppet constant id'>Puppet</span><span class='lbrack token'>[</span><span class='symbol val'>:ssl_client_ca_chain</span><span class='rbrack token'>]</span><span class='comma token'>,</span>
                                        <span class='symbol val'>:ca_auth_file</span>  <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_Puppet constant id'>Puppet</span><span class='lbrack token'>[</span><span class='symbol val'>:ssl_client_ca_auth</span><span class='rbrack token'>]</span>
                                      <span class='rbrace token'>}</span><span class='rparen token'>)</span><span class='comma token'>,</span>
    <span class='rubyid_ssl_host identifier id'>ssl_host</span> <span class='assign token'>=</span> <span class='rubyid_Puppet constant id'>Puppet</span><span class='colon2 op'>::</span><span class='rubyid_SSL constant id'>SSL</span><span class='colon2 op'>::</span><span class='rubyid_Host constant id'>Host</span><span class='dot token'>.</span><span class='rubyid_localhost identifier id'>localhost</span><span class='rparen token'>)</span>

  <span class='rubyid_reset! fid id'>reset!</span>
  <span class='rubyid_@ssl_configuration ivar id'>@ssl_configuration</span> <span class='assign token'>=</span> <span class='rubyid_ssl_configuration identifier id'>ssl_configuration</span>
  <span class='rubyid_@ssl_host ivar id'>@ssl_host</span> <span class='assign token'>=</span> <span class='rubyid_ssl_host identifier id'>ssl_host</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="call-instance_method">
  
    - (<tt>Boolean</tt>) <strong>call</strong>(preverify_ok, ssl_context) &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Performs verification of the SSL connection and collection of the
certificates for use in constructing the error message if the verification
failed.  This callback will be executed once for each certificate in a
chain being verified.</p>

<p>From the <a href="http://www.openssl.org/docs/ssl/SSL_CTX_set_verify.html">OpenSSL
documentation</a>:
The <code>verify_callback</code> function is used to control the behaviour when the
SSL_VERIFY_PEER flag is set. It must be supplied by the application and
receives two arguments: preverify_ok indicates, whether the verification of
the certificate in question was passed (preverify_ok=1) or not
(preverify_ok=0). x509_ctx is a pointer to the complete context used for
the certificate chain verification.</p>

<p>See href="HTTP::Connection">HTTP::Connection</a> for more information and where this
class is intended to be used.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>preverify_ok</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>indicates whether the verification of the
certificate in question was passed (preverify_ok=true)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ssl_context</span>
      
      
        <span class='type'>(<tt><span class='object_link'>OpenSSL::SSL::SSLContext</span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>holds the SSLContext for the
chain being verified.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>false if the peer is invalid, true otherwise.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/ssl/validator/default_validator.rb', line 69</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_call identifier id'>call</span><span class='lparen token'>(</span><span class='rubyid_preverify_ok identifier id'>preverify_ok</span><span class='comma token'>,</span> <span class='rubyid_ssl_context identifier id'>ssl_context</span><span class='rparen token'>)</span>
  <span class='comment val'># We must make a copy since the scope of the ssl_context will be lost</span>
  <span class='comment val'># across invocations of this method.</span>
  <span class='rubyid_current_cert identifier id'>current_cert</span> <span class='assign token'>=</span> <span class='rubyid_ssl_context identifier id'>ssl_context</span><span class='dot token'>.</span><span class='rubyid_current_cert identifier id'>current_cert</span>
  <span class='rubyid_@peer_certs ivar id'>@peer_certs</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_Puppet constant id'>Puppet</span><span class='colon2 op'>::</span><span class='rubyid_SSL constant id'>SSL</span><span class='colon2 op'>::</span><span class='rubyid_Certificate constant id'>Certificate</span><span class='dot token'>.</span><span class='rubyid_from_instance identifier id'>from_instance</span><span class='lparen token'>(</span><span class='rubyid_current_cert identifier id'>current_cert</span><span class='rparen token'>)</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_preverify_ok identifier id'>preverify_ok</span>
    <span class='comment val'># If we've copied all of the certs in the chain out of the SSL library</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_@peer_certs ivar id'>@peer_certs</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span> <span class='eq op'>==</span> <span class='rubyid_ssl_context identifier id'>ssl_context</span><span class='dot token'>.</span><span class='rubyid_chain identifier id'>chain</span><span class='dot token'>.</span><span class='rubyid_length identifier id'>length</span>
      <span class='comment val'># (#20027) The peer cert must be issued by a specific authority</span>
      <span class='rubyid_preverify_ok identifier id'>preverify_ok</span> <span class='assign token'>=</span> <span class='rubyid_valid_peer? fid id'>valid_peer?</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_if if kw'>if</span> <span class='rubyid_ssl_context identifier id'>ssl_context</span><span class='dot token'>.</span><span class='rubyid_error_string identifier id'>error_string</span>
      <span class='rubyid_@verify_errors ivar id'>@verify_errors</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;#{ssl_context.error_string} for #{current_cert.subject}&quot;</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_preverify_ok identifier id'>preverify_ok</span>
<span class='rubyid_rescue rescue kw'>rescue</span> <span class='assign token'>=</span><span class='gt op'>&gt;</span> <span class='rubyid_ex identifier id'>ex</span>
  <span class='rubyid_@verify_errors ivar id'>@verify_errors</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_ex identifier id'>ex</span><span class='dot token'>.</span><span class='rubyid_message identifier id'>message</span>
  <span class='rubyid_false false kw'>false</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_authz_peer_cert-instance_method">
  
    - (<tt>Boolean</tt>) <strong>has_authz_peer_cert</strong>(peer_certs, authz_certs) &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Checks if the set of peer_certs contains at least one certificate issued
by a certificate listed in authz_certs</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


140
141
142
143
144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/ssl/validator/default_validator.rb', line 140</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_has_authz_peer_cert identifier id'>has_authz_peer_cert</span><span class='lparen token'>(</span><span class='rubyid_peer_certs identifier id'>peer_certs</span><span class='comma token'>,</span> <span class='rubyid_authz_certs identifier id'>authz_certs</span><span class='rparen token'>)</span>
  <span class='rubyid_peer_certs identifier id'>peer_certs</span><span class='dot token'>.</span><span class='rubyid_any? fid id'>any?</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_peer_cert identifier id'>peer_cert</span><span class='bitor op'>|</span>
    <span class='rubyid_authz_certs identifier id'>authz_certs</span><span class='dot token'>.</span><span class='rubyid_any? fid id'>any?</span> <span class='rubyid_do do kw'>do</span> <span class='bitor op'>|</span><span class='rubyid_authz_cert identifier id'>authz_cert</span><span class='bitor op'>|</span>
      <span class='rubyid_peer_cert identifier id'>peer_cert</span><span class='dot token'>.</span><span class='rubyid_verify identifier id'>verify</span><span class='lparen token'>(</span><span class='rubyid_authz_cert identifier id'>authz_cert</span><span class='dot token'>.</span><span class='rubyid_public_key identifier id'>public_key</span><span class='rparen token'>)</span>
    <span class='rubyid_end end kw'>end</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reset!-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>reset!</strong> &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Resets this validator to its initial validation state. The ssl configuration is not changed.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


38
39
40
41</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/ssl/validator/default_validator.rb', line 38</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_reset! fid id'>reset!</span>
  <span class='rubyid_@peer_certs ivar id'>@peer_certs</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
  <span class='rubyid_@verify_errors ivar id'>@verify_errors</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='rbrack token'>]</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="setup_connection-instance_method">
  
    - <strong>setup_connection</strong>(connection) &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p class="note returns_void">This method returns an undefined value.</p><p>Registers the instance's call method with the connection.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>connection</span>
      
      
        <span class='type'>(<tt>Net::HTTP</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The connection to validate</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


100
101
102
103
104
105
106
107
108
109
110
111</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/ssl/validator/default_validator.rb', line 100</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_setup_connection identifier id'>setup_connection</span><span class='lparen token'>(</span><span class='rubyid_connection identifier id'>connection</span><span class='rparen token'>)</span>
  <span class='rubyid_if if kw'>if</span> <span class='rubyid_ssl_certificates_are_present? fid id'>ssl_certificates_are_present?</span>
    <span class='rubyid_connection identifier id'>connection</span><span class='dot token'>.</span><span class='rubyid_cert_store identifier id'>cert_store</span> <span class='assign token'>=</span> <span class='rubyid_@ssl_host ivar id'>@ssl_host</span><span class='dot token'>.</span><span class='rubyid_ssl_store identifier id'>ssl_store</span>
    <span class='rubyid_connection identifier id'>connection</span><span class='dot token'>.</span><span class='rubyid_ca_file identifier id'>ca_file</span> <span class='assign token'>=</span> <span class='rubyid_@ssl_configuration ivar id'>@ssl_configuration</span><span class='dot token'>.</span><span class='rubyid_ca_auth_file identifier id'>ca_auth_file</span>
    <span class='rubyid_connection identifier id'>connection</span><span class='dot token'>.</span><span class='rubyid_cert identifier id'>cert</span> <span class='assign token'>=</span> <span class='rubyid_@ssl_host ivar id'>@ssl_host</span><span class='dot token'>.</span><span class='rubyid_certificate identifier id'>certificate</span><span class='dot token'>.</span><span class='rubyid_content identifier id'>content</span>
    <span class='rubyid_connection identifier id'>connection</span><span class='dot token'>.</span><span class='rubyid_key identifier id'>key</span> <span class='assign token'>=</span> <span class='rubyid_@ssl_host ivar id'>@ssl_host</span><span class='dot token'>.</span><span class='rubyid_key identifier id'>key</span><span class='dot token'>.</span><span class='rubyid_content identifier id'>content</span>
    <span class='rubyid_connection identifier id'>connection</span><span class='dot token'>.</span><span class='rubyid_verify_mode identifier id'>verify_mode</span> <span class='assign token'>=</span> <span class='rubyid_OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='rubyid_SSL constant id'>SSL</span><span class='colon2 op'>::</span><span class='rubyid_VERIFY_PEER constant id'>VERIFY_PEER</span>
    <span class='rubyid_connection identifier id'>connection</span><span class='dot token'>.</span><span class='rubyid_verify_callback identifier id'>verify_callback</span> <span class='assign token'>=</span> <span class='rubyid_self self kw'>self</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_connection identifier id'>connection</span><span class='dot token'>.</span><span class='rubyid_verify_mode identifier id'>verify_mode</span> <span class='assign token'>=</span> <span class='rubyid_OpenSSL constant id'>OpenSSL</span><span class='colon2 op'>::</span><span class='rubyid_SSL constant id'>SSL</span><span class='colon2 op'>::</span><span class='rubyid_VERIFY_NONE constant id'>VERIFY_NONE</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="ssl_certificates_are_present?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>ssl_certificates_are_present?</strong> &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>



  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


150
151
152</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/ssl/validator/default_validator.rb', line 150</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_ssl_certificates_are_present? fid id'>ssl_certificates_are_present?</span>
  <span class='rubyid_Puppet constant id'>Puppet</span><span class='colon2 op'>::</span><span class='rubyid_FileSystem constant id'>FileSystem</span><span class='colon2 op'>::</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='rubyid_Puppet constant id'>Puppet</span><span class='lbrack token'>[</span><span class='symbol val'>:hostcert</span><span class='rbrack token'>]</span><span class='rparen token'>)</span> <span class='andop op'>&amp;&amp;</span> <span class='rubyid_Puppet constant id'>Puppet</span><span class='colon2 op'>::</span><span class='rubyid_FileSystem constant id'>FileSystem</span><span class='colon2 op'>::</span><span class='rubyid_File constant id'>File</span><span class='dot token'>.</span><span class='rubyid_exist? fid id'>exist?</span><span class='lparen token'>(</span><span class='rubyid_@ssl_configuration ivar id'>@ssl_configuration</span><span class='dot token'>.</span><span class='rubyid_ca_auth_file identifier id'>ca_auth_file</span><span class='rparen token'>)</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="valid_peer?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>valid_peer?</strong> &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Validates the peer certificates against the authorized certificates.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/ssl/validator/default_validator.rb', line 117</span>

<span class='rubyid_def def kw'>def</span> <span class='rubyid_valid_peer? fid id'>valid_peer?</span>
  <span class='rubyid_descending_cert_chain identifier id'>descending_cert_chain</span> <span class='assign token'>=</span> <span class='rubyid_@peer_certs ivar id'>@peer_certs</span><span class='dot token'>.</span><span class='rubyid_reverse identifier id'>reverse</span><span class='dot token'>.</span><span class='rubyid_map identifier id'>map</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='rubyid_c identifier id'>c</span><span class='bitor op'>|</span> <span class='rubyid_c identifier id'>c</span><span class='dot token'>.</span><span class='rubyid_content identifier id'>content</span> <span class='rbrace token'>}</span>
  <span class='rubyid_authz_ca_certs identifier id'>authz_ca_certs</span> <span class='assign token'>=</span> <span class='rubyid_ssl_configuration identifier id'>ssl_configuration</span><span class='dot token'>.</span><span class='rubyid_ca_auth_certificates identifier id'>ca_auth_certificates</span>

  <span class='rubyid_if if kw'>if</span> <span class='rubyid_not not kw'>not</span> <span class='rubyid_has_authz_peer_cert identifier id'>has_authz_peer_cert</span><span class='lparen token'>(</span><span class='rubyid_descending_cert_chain identifier id'>descending_cert_chain</span><span class='comma token'>,</span> <span class='rubyid_authz_ca_certs identifier id'>authz_ca_certs</span><span class='rparen token'>)</span>
    <span class='rubyid_msg identifier id'>msg</span> <span class='assign token'>=</span> <span class='string val'>&quot;The server presented a SSL certificate chain which does not include a &quot;</span> <span class='lshft op'>&lt;&lt;</span>
      <span class='string val'>&quot;CA listed in the ssl_client_ca_auth file.  &quot;</span>
    <span class='rubyid_msg identifier id'>msg</span> <span class='lshft op'>&lt;&lt;</span> <span class='dstring node'>&quot;Authorized Issuers: #{authz_ca_certs.collect {|c| c.subject}.join(', ')}  &quot;</span> <span class='lshft op'>&lt;&lt;</span>
      <span class='dstring node'>&quot;Peer Chain: #{descending_cert_chain.collect {|c| c.subject}.join(' =&gt; ')}&quot;</span>
    <span class='rubyid_@verify_errors ivar id'>@verify_errors</span> <span class='lshft op'>&lt;&lt;</span> <span class='rubyid_msg identifier id'>msg</span>
    <span class='rubyid_false false kw'>false</span>
  <span class='rubyid_else else kw'>else</span>
    <span class='rubyid_true true kw'>true</span>
  <span class='rubyid_end end kw'>end</span>
<span class='rubyid_end end kw'>end</span>
</pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Tue Feb 11 13:05:43 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.3 (ruby-1.8.7).
</div>

  </body>
</html>
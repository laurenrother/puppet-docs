<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Puppet::Pops::Functions::Dispatcher
  
    &mdash; Documentation by YARD 0.8.7.4
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  hasFrames = window.top.frames.main ? true : false;
  relpath = '../../../';
  framesUrl = "../../../frames.html#!Puppet/Pops/Functions/Dispatcher.html";
</script>


  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (D)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Puppet.html" title="Puppet (module)">Puppet</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Pops.html" title="Puppet::Pops (module)">Pops</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Functions.html" title="Puppet::Pops::Functions (module)">Functions</a></span></span>
     &raquo; 
    <span class="title">Dispatcher</span>
  

  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">
      Class List
    </a>
  
    <a class="full_list_link" id="method_list_link"
        href="../../../method_list.html">
      Method List
    </a>
  
    <a class="full_list_link" id="file_list_link"
        href="../../../file_list.html">
      File List
    </a>
  
</div>
      <div class="clear"></div>
    </div>

    <iframe id="search_frame"></iframe>

    <div id="content"><h1>Class: Puppet::Pops::Functions::Dispatcher
  
  
  <span class="private note title">Private</span>
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'>Object</span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'>Object</span></li>
          
            <li class="next">Puppet::Pops::Functions::Dispatcher</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/puppet/pops/functions/dispatcher.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This class is part of a private API.</strong>
  You should avoid using this class if possible, as it may be removed or be changed in the future.
</p>
<p>Evaluate the dispatches defined as <span class='object_link'><a href="Dispatch.html" title="Puppet::Pops::Functions::Dispatch (class)">Dispatch</a></span>
instances to call the appropriate method on the
<span class='object_link'><a href="Function.html" title="Puppet::Pops::Functions::Function (class)">Function</a></span> instance.</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#add_dispatch-instance_method" title="#add_dispatch (instance method)">- (Object) <strong>add_dispatch</strong>(type, method_name, param_names, block_name, injections, weaving, last_captures) </a>
    

    
  </span>
  
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Adds a regular dispatch for one method name.</p>
</div></span>
  
</li>

      
        
<li class="private ">
  <span class="summary_signature">
    
      <a href="#arg_count_string-instance_method" title="#arg_count_string (instance method)">- (Object) <strong>arg_count_string</strong>(args_type) </a>
    

    
  </span>
  
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="private ">
  <span class="summary_signature">
    
      <a href="#arg_types_string-instance_method" title="#arg_types_string (instance method)">- (Object) <strong>arg_types_string</strong>(args_type) </a>
    

    
  </span>
  
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="private ">
  <span class="summary_signature">
    
      <a href="#diff_string-instance_method" title="#diff_string (instance method)">- (Object) <strong>diff_string</strong>(name, args_type) </a>
    

    
  </span>
  
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Produces a string with the difference between the given arguments and support signature(s).</p>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#dispatch-instance_method" title="#dispatch (instance method)">- (Object) <strong>dispatch</strong>(instance, calling_scope, args) </a>
    

    
  </span>
  
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Dispatches the call to the first found signature (entry with matching type).</p>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#empty%3F-instance_method" title="#empty? (instance method)">- (Boolean) <strong>empty?</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Answers if dispatching has been defined.</p>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Dispatcher) <strong>initialize</strong> </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>A new instance of Dispatcher.</p>
</div></span>
  
</li>

      
        
<li class="private ">
  <span class="summary_signature">
    
      <a href="#max-instance_method" title="#max (instance method)">- (Object) <strong>max</strong>(a, b) </a>
    

    
  </span>
  
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Why oh why Ruby do you not have a standard Math.max ?.</p>
</div></span>
  
</li>

      
        
<li class="private ">
  <span class="summary_signature">
    
      <a href="#opt_value_indicator-instance_method" title="#opt_value_indicator (instance method)">- (Object) <strong>opt_value_indicator</strong>(index, required_count, limit) </a>
    

    
  </span>
  
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="private ">
  <span class="summary_signature">
    
      <a href="#range_string-instance_method" title="#range_string (instance method)">- (Object) <strong>range_string</strong>(size_range, squelch_one = true) </a>
    

    
  </span>
  
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Formats a range into a string of the form: <code>{from, to}</code>.</p>
</div></span>
  
</li>

      
        
<li class="private ">
  <span class="summary_signature">
    
      <a href="#signature_string-instance_method" title="#signature_string (instance method)">- (Object) <strong>signature_string</strong>(dispatch) </a>
    

    
  </span>
  
  
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Produces a string for the signature(s).</p>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#signatures-instance_method" title="#signatures (instance method)">- (Object) <strong>signatures</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'>
</div></span>
  
</li>

      
        
<li class="public ">
  <span class="summary_signature">
    
      <a href="#to_type-instance_method" title="#to_type (instance method)">- (Object) <strong>to_type</strong> </a>
    

    
  </span>
  
  
  
  
  
  
  
  <span class="private note title">private</span>

  
    <span class="summary_desc"><div class='inline'><p>Produces a CallableType for a single signature, and a Variant[] otherwise.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Puppet::Pops::Functions::Dispatcher (class)">Dispatcher</a></span></tt>) <strong>initialize</strong> &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Returns a new instance of Dispatcher</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


10
11
12</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 10</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='ivar'>@dispatchers</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_dispatch-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>add_dispatch</strong>(type, method_name, param_names, block_name, injections, weaving, last_captures) &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Adds a regular dispatch for one method name</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Types/PArrayType.html" title="Puppet::Pops::Types::PArrayType (class)">Puppet::Pops::Types::PArrayType</a></span></tt>, <tt><span class='object_link'><a href="../Types/PTupleType.html" title="Puppet::Pops::Types::PTupleType (class)">Puppet::Pops::Types::PTupleType</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
<li>type describing signature</li>
</ul>

</div>
      
    </li>
  
    <li>
      
        <span class='name'>method_name</span>
      
      
        <span class='type'>(<tt><span class='object_link'>String</span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
<li>the name of the method that will be called when type matches given arguments</li>
</ul>

</div>
      
    </li>
  
    <li>
      
        <span class='name'>names</span>
      
      
        <span class='type'>(<tt><span class='object_link'>Array</span>&lt;<span class='object_link'>String</span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
<li>array with names matching the number of parameters specified by type (or empty array)</li>
</ul>

</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 48</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_dispatch'>add_dispatch</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_method_name'>method_name</span><span class='comma'>,</span> <span class='id identifier rubyid_param_names'>param_names</span><span class='comma'>,</span> <span class='id identifier rubyid_block_name'>block_name</span><span class='comma'>,</span> <span class='id identifier rubyid_injections'>injections</span><span class='comma'>,</span> <span class='id identifier rubyid_weaving'>weaving</span><span class='comma'>,</span> <span class='id identifier rubyid_last_captures'>last_captures</span><span class='rparen'>)</span>
  <span class='ivar'>@dispatchers</span> <span class='op'>&lt;&lt;</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Functions</span><span class='op'>::</span><span class='const'>Dispatch</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_method_name'>method_name</span><span class='comma'>,</span> <span class='id identifier rubyid_param_names'>param_names</span><span class='comma'>,</span> <span class='id identifier rubyid_block_name'>block_name</span><span class='comma'>,</span> <span class='id identifier rubyid_injections'>injections</span><span class='comma'>,</span> <span class='id identifier rubyid_weaving'>weaving</span><span class='comma'>,</span> <span class='id identifier rubyid_last_captures'>last_captures</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="arg_count_string-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>arg_count_string</strong>(args_type)  <span class="extras">(private)</span>&nbsp;<span class="note title private">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 170</span>

<span class='kw'>def</span> <span class='id identifier rubyid_arg_count_string'>arg_count_string</span><span class='lparen'>(</span><span class='id identifier rubyid_args_type'>args_type</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_args_type'>args_type</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>PCallableType</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_size_range'>size_range</span> <span class='op'>=</span> <span class='id identifier rubyid_args_type'>args_type</span><span class='period'>.</span><span class='id identifier rubyid_param_types'>param_types</span><span class='period'>.</span><span class='id identifier rubyid_size_range'>size_range</span> <span class='comment'># regular parameters
</span>    <span class='id identifier rubyid_adjust_range'>adjust_range</span><span class='op'>=</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_args_type'>args_type</span><span class='period'>.</span><span class='id identifier rubyid_block_type'>block_type</span>
    <span class='kw'>when</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>POptionalType</span>
      <span class='id identifier rubyid_size_range'>size_range</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>when</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>PCallableType</span>
      <span class='id identifier rubyid_size_range'>size_range</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_size_range'>size_range</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>when</span> <span class='const'>NilClass</span>
      <span class='comment'># nothing
</span>    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Internal Error, only nil, Callable, and Optional[Callable] supported by Callable block type</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_size_range'>size_range</span> <span class='op'>=</span> <span class='id identifier rubyid_args_type'>args_type</span><span class='period'>.</span><span class='id identifier rubyid_size_range'>size_range</span>
  <span class='kw'>end</span>
  <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>arg count </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_range_string'>range_string</span><span class='lparen'>(</span><span class='id identifier rubyid_size_range'>size_range</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="arg_types_string-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>arg_types_string</strong>(args_type)  <span class="extras">(private)</span>&nbsp;<span class="note title private">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 192</span>

<span class='kw'>def</span> <span class='id identifier rubyid_arg_types_string'>arg_types_string</span><span class='lparen'>(</span><span class='id identifier rubyid_args_type'>args_type</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_types'>types</span> <span class='op'>=</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_args_type'>args_type</span>
  <span class='kw'>when</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>PTupleType</span>
    <span class='id identifier rubyid_last_range'>last_range</span> <span class='op'>=</span> <span class='id identifier rubyid_args_type'>args_type</span><span class='period'>.</span><span class='id identifier rubyid_repeat_last_range'>repeat_last_range</span>
    <span class='id identifier rubyid_args_type'>args_type</span><span class='period'>.</span><span class='id identifier rubyid_types'>types</span>
  <span class='kw'>when</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>PArrayType</span>
    <span class='id identifier rubyid_last_range'>last_range</span> <span class='op'>=</span> <span class='id identifier rubyid_args_type'>args_type</span><span class='period'>.</span><span class='id identifier rubyid_size_range'>size_range</span>
    <span class='lbracket'>[</span> <span class='id identifier rubyid_args_type'>args_type</span><span class='period'>.</span><span class='id identifier rubyid_element_type'>element_type</span> <span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='comment'># stringify generalized versions or it will display Integer[10,10] for &quot;10&quot;, String[&#39;the content&#39;] etc.
</span>  <span class='comment'># note that type must be copied since generalize is a mutating operation
</span>  <span class='id identifier rubyid_tc'>tc</span> <span class='op'>=</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>TypeCalculator</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_types'>types</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='op'>|</span> <span class='id identifier rubyid_tc'>tc</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span><span class='lparen'>(</span><span class='id identifier rubyid_tc'>tc</span><span class='period'>.</span><span class='id identifier rubyid_generalize!'>generalize!</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='period'>.</span><span class='id identifier rubyid_copy'>copy</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='comment'># Add {from, to} for the last type
</span>  <span class='comment'># This works for both Array and Tuple since it describes the allowed count of the &quot;last&quot; type element
</span>  <span class='comment'># for both. It does not show anything when the range is {1,1}.
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_result'>result</span> <span class='op'>+=</span> <span class='id identifier rubyid_range_string'>range_string</span><span class='lparen'>(</span><span class='id identifier rubyid_last_range'>last_range</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="diff_string-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>diff_string</strong>(name, args_type)  <span class="extras">(private)</span>&nbsp;<span class="note title private">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Produces a string with the difference between the given arguments and support signature(s).</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 76</span>

<span class='kw'>def</span> <span class='id identifier rubyid_diff_string'>diff_string</span><span class='lparen'>(</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_args_type'>args_type</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='ivar'>@dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&lt;</span> <span class='int'>2</span>
    <span class='id identifier rubyid_dispatch'>dispatch</span> <span class='op'>=</span> <span class='ivar'>@dispatchers</span><span class='lbracket'>[</span> <span class='int'>0</span> <span class='rbracket'>]</span>
    <span class='id identifier rubyid_params_type'>params_type</span>  <span class='op'>=</span> <span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_param_types'>param_types</span>
    <span class='id identifier rubyid_block_type'>block_type</span>   <span class='op'>=</span> <span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_block_type'>block_type</span>
    <span class='id identifier rubyid_params_names'>params_names</span> <span class='op'>=</span> <span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_param_names'>param_names</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>expected:\n  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_signature_string'>signature_string</span><span class='lparen'>(</span><span class='id identifier rubyid_dispatch'>dispatch</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>) - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg_count_string'>arg_count_string</span><span class='lparen'>(</span><span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>expected one of:\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='lparen'>(</span><span class='ivar'>@dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_d'>d</span><span class='op'>|</span>
      <span class='id identifier rubyid_params_type'>params_type</span> <span class='op'>=</span> <span class='id identifier rubyid_d'>d</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_param_types'>param_types</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_signature_string'>signature_string</span><span class='lparen'>(</span><span class='id identifier rubyid_d'>d</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>) - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg_count_string'>arg_count_string</span><span class='lparen'>(</span><span class='id identifier rubyid_d'>d</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\nactual:\n  </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>(</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg_types_string'>arg_types_string</span><span class='lparen'>(</span><span class='id identifier rubyid_args_type'>args_type</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>) - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_arg_count_string'>arg_count_string</span><span class='lparen'>(</span><span class='id identifier rubyid_args_type'>args_type</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="dispatch-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>dispatch</strong>(instance, calling_scope, args) &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Dispatches the call to the first found signature (entry with matching type).</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>instance</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Functions/Function.html" title="Puppet::Functions::Function (class)">Puppet::Functions::Function</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
<li>the function to call</li>
</ul>

</div>
      
    </li>
  
    <li>
      
        <span class='name'>calling_scope</span>
      
      
        <span class='type'>(<tt>T.B.D::Scope</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
<li>the scope of the caller</li>
</ul>

</div>
      
    </li>
  
    <li>
      
        <span class='name'>args</span>
      
      
        <span class='type'>(<tt><span class='object_link'>Array</span>&lt;<span class='object_link'>Object</span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
<li>the given arguments in the form of an Array</li>
</ul>

</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'>Object</span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul>
<li>what the called function produced</li>
</ul>

</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


30
31
32
33
34
35
36
37
38
39</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 30</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dispatch'>dispatch</span><span class='lparen'>(</span><span class='id identifier rubyid_instance'>instance</span><span class='comma'>,</span> <span class='id identifier rubyid_calling_scope'>calling_scope</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tc'>tc</span> <span class='op'>=</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>TypeCalculator</span>
  <span class='id identifier rubyid_actual'>actual</span> <span class='op'>=</span> <span class='id identifier rubyid_tc'>tc</span><span class='period'>.</span><span class='id identifier rubyid_infer_set'>infer_set</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_found'>found</span> <span class='op'>=</span> <span class='ivar'>@dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_d'>d</span><span class='op'>|</span> <span class='id identifier rubyid_tc'>tc</span><span class='period'>.</span><span class='id identifier rubyid_callable?'>callable?</span><span class='lparen'>(</span><span class='id identifier rubyid_d'>d</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_actual'>actual</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_found'>found</span>
    <span class='id identifier rubyid_found'>found</span><span class='period'>.</span><span class='id identifier rubyid_invoke'>invoke</span><span class='lparen'>(</span><span class='id identifier rubyid_instance'>instance</span><span class='comma'>,</span> <span class='id identifier rubyid_calling_scope'>calling_scope</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>function &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; called with mis-matched arguments\n</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_diff_string'>diff_string</span><span class='lparen'>(</span><span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_actual'>actual</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="empty?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>empty?</strong> &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Answers if dispatching has been defined</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>true if dispatching has been defined</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 18</span>

<span class='kw'>def</span> <span class='id identifier rubyid_empty?'>empty?</span>
  <span class='ivar'>@dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="max-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>max</strong>(a, b)  <span class="extras">(private)</span>&nbsp;<span class="note title private">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Why oh why Ruby do you not have a standard Math.max ?</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_max'>max</span><span class='lparen'>(</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span> <span class='id identifier rubyid_b'>b</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_a'>a</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_b'>b</span> <span class='op'>?</span> <span class='id identifier rubyid_a'>a</span> <span class='op'>:</span> <span class='id identifier rubyid_b'>b</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="opt_value_indicator-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>opt_value_indicator</strong>(index, required_count, limit)  <span class="extras">(private)</span>&nbsp;<span class="note title private">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


164
165
166
167</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 164</span>

<span class='kw'>def</span> <span class='id identifier rubyid_opt_value_indicator'>opt_value_indicator</span><span class='lparen'>(</span><span class='id identifier rubyid_index'>index</span><span class='comma'>,</span> <span class='id identifier rubyid_required_count'>required_count</span><span class='comma'>,</span> <span class='id identifier rubyid_limit'>limit</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='id identifier rubyid_index'>index</span> <span class='op'>+</span> <span class='int'>1</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_required_count'>required_count</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_count'>count</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_limit'>limit</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>?</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="range_string-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>range_string</strong>(size_range, squelch_one = true)  <span class="extras">(private)</span>&nbsp;<span class="note title private">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Formats a range into a string of the form: <code>{from, to}</code></p>

<p>The following cases are optimized:</p>

<ul>
<li>from and to are equal => <code>{from}</code></li>
<li>from and to are both and 1 and squelch_one == true => <code>''</code></li>
<li>from is 0 and to is 1 => <code>'?'</code></li>
<li>to is INFINITY => <code>{from, }</code></li>
</ul>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


225
226
227
228
229
230
231
232
233
234
235
236</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 225</span>

<span class='kw'>def</span> <span class='id identifier rubyid_range_string'>range_string</span><span class='lparen'>(</span><span class='id identifier rubyid_size_range'>size_range</span><span class='comma'>,</span> <span class='id identifier rubyid_squelch_one'>squelch_one</span> <span class='op'>=</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_from'>from</span><span class='comma'>,</span> <span class='id identifier rubyid_to'>to</span> <span class='op'>=</span> <span class='id identifier rubyid_size_range'>size_range</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_from'>from</span> <span class='op'>==</span> <span class='id identifier rubyid_to'>to</span>
    <span class='lparen'>(</span><span class='id identifier rubyid_squelch_one'>squelch_one</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_from'>from</span> <span class='op'>==</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>{</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_from'>from</span><span class='embexpr_end'>}</span><span class='tstring_content'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_to'>to</span> <span class='op'>==</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>INFINITY</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>{</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_from'>from</span><span class='embexpr_end'>}</span><span class='tstring_content'>,}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_from'>from</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_to'>to</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>?</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>else</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>{</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_from'>from</span><span class='embexpr_end'>}</span><span class='tstring_content'>,</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_to'>to</span><span class='embexpr_end'>}</span><span class='tstring_content'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="signature_string-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>signature_string</strong>(dispatch)  <span class="extras">(private)</span>&nbsp;<span class="note title private">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Produces a string for the signature(s)</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 98</span>

<span class='kw'>def</span> <span class='id identifier rubyid_signature_string'>signature_string</span><span class='lparen'>(</span><span class='id identifier rubyid_dispatch'>dispatch</span><span class='rparen'>)</span> <span class='comment'># args_type, param_names
</span>  <span class='id identifier rubyid_param_types'>param_types</span>  <span class='op'>=</span> <span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_param_types'>param_types</span>
  <span class='id identifier rubyid_block_type'>block_type</span>   <span class='op'>=</span> <span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_block_type'>block_type</span>
  <span class='id identifier rubyid_param_names'>param_names</span> <span class='op'>=</span> <span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_param_names'>param_names</span>

  <span class='id identifier rubyid_from'>from</span><span class='comma'>,</span> <span class='id identifier rubyid_to'>to</span> <span class='op'>=</span> <span class='id identifier rubyid_param_types'>param_types</span><span class='period'>.</span><span class='id identifier rubyid_size_range'>size_range</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_from'>from</span> <span class='op'>==</span> <span class='int'>0</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_to'>to</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='comment'># No parameters function
</span>    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_required_count'>required_count</span> <span class='op'>=</span> <span class='id identifier rubyid_from'>from</span>
  <span class='comment'># there may be more names than there are types, and count needs to be subtracted from the count
</span>  <span class='comment'># to make it correct for the last named element
</span>  <span class='id identifier rubyid_adjust'>adjust</span> <span class='op'>=</span> <span class='id identifier rubyid_max'>max</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_param_names'>param_names</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_last_range'>last_range</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_max'>max</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_from'>from</span> <span class='op'>-</span> <span class='id identifier rubyid_adjust'>adjust</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_to'>to</span> <span class='op'>-</span> <span class='id identifier rubyid_adjust'>adjust</span><span class='rparen'>)</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_types'>types</span> <span class='op'>=</span>
  <span class='kw'>case</span> <span class='id identifier rubyid_param_types'>param_types</span>
  <span class='kw'>when</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>PTupleType</span>
    <span class='id identifier rubyid_param_types'>param_types</span><span class='period'>.</span><span class='id identifier rubyid_types'>types</span>
  <span class='kw'>when</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>PArrayType</span>
    <span class='lbracket'>[</span> <span class='id identifier rubyid_param_types'>param_types</span><span class='period'>.</span><span class='id identifier rubyid_element_type'>element_type</span> <span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_tc'>tc</span> <span class='op'>=</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>TypeCalculator</span>

  <span class='comment'># join type with names (types are always present, names are optional)
</span>  <span class='comment'># separate entries with comma
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_param_names'>param_names</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_types'>types</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_t'>t</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span><span class='op'>|</span> <span class='id identifier rubyid_tc'>tc</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span><span class='lparen'>(</span><span class='id identifier rubyid_t'>t</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_opt_value_indicator'>opt_value_indicator</span><span class='lparen'>(</span><span class='id identifier rubyid_index'>index</span><span class='comma'>,</span> <span class='id identifier rubyid_required_count'>required_count</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_limit'>limit</span> <span class='op'>=</span> <span class='id identifier rubyid_param_names'>param_names</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_param_names'>param_names</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span><span class='op'>|</span>
      <span class='lbracket'>[</span><span class='id identifier rubyid_tc'>tc</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span><span class='lparen'>(</span><span class='id identifier rubyid_types'>types</span><span class='lbracket'>[</span><span class='id identifier rubyid_index'>index</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_types'>types</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'> </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='id identifier rubyid_opt_value_indicator'>opt_value_indicator</span><span class='lparen'>(</span><span class='id identifier rubyid_index'>index</span><span class='comma'>,</span> <span class='id identifier rubyid_required_count'>required_count</span><span class='comma'>,</span> <span class='id identifier rubyid_limit'>limit</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='comment'># Add {from, to} for the last type
</span>  <span class='comment'># This works for both Array and Tuple since it describes the allowed count of the &quot;last&quot; type element
</span>  <span class='comment'># for both. It does not show anything when the range is {1,1}.
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_result'>result</span> <span class='op'>+=</span> <span class='id identifier rubyid_range_string'>range_string</span><span class='lparen'>(</span><span class='id identifier rubyid_last_range'>last_range</span><span class='rparen'>)</span>

  <span class='comment'># If there is a block, include it with its own optional count {0,1}
</span>  <span class='kw'>case</span> <span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_block_type'>block_type</span>
  <span class='kw'>when</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>POptionalType</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_result'>result</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tc'>tc</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span><span class='lparen'>(</span><span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_block_type'>block_type</span><span class='period'>.</span><span class='id identifier rubyid_optional_type'>optional_type</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_block_name'>block_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> {0,1}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>when</span> <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>PCallableType</span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_result'>result</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_result'>result</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tc'>tc</span><span class='period'>.</span><span class='id identifier rubyid_string'>string</span><span class='lparen'>(</span><span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_block_type'>block_type</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_block_name'>block_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>when</span> <span class='const'>NilClass</span>
    <span class='comment'># nothing
</span>  <span class='kw'>end</span>
  <span class='id identifier rubyid_result'>result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="signatures-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>signatures</strong> &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>



  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


67
68
69</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 67</span>

<span class='kw'>def</span> <span class='id identifier rubyid_signatures'>signatures</span>
  <span class='ivar'>@dispatchers</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_type-instance_method">
  
    - (<tt><span class='object_link'>Object</span></tt>) <strong>to_type</strong> &nbsp;<span class="private note title">private</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note private">
  <strong>This method is part of a private API.</strong>
  You should avoid using this method if possible, as it may be removed or be changed in the future.
</p>
<p>Produces a CallableType for a single signature, and a Variant[<callables>] otherwise</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


55
56
57
58
59
60
61
62
63
64</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/puppet/pops/functions/dispatcher.rb', line 55</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_type'>to_type</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='comment'># make a copy to make sure it can be contained by someone else (even if it is not contained here, it
</span>  <span class='comment'># should be treated as immutable).
</span>  <span class='comment'>#
</span>  <span class='id identifier rubyid_callables'>callables</span> <span class='op'>=</span> <span class='id identifier rubyid_dispatchers'>dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span> <span class='id identifier rubyid_dispatch'>dispatch</span> <span class='op'>|</span> <span class='id identifier rubyid_dispatch'>dispatch</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='period'>.</span><span class='id identifier rubyid_copy'>copy</span> <span class='rbrace'>}</span>

  <span class='comment'># multiple signatures, produce a Variant type of Callable1-n (must copy them)
</span>  <span class='comment'># single signature, produce single Callable
</span>  <span class='id identifier rubyid_callables'>callables</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span> <span class='op'>?</span>  <span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Pops</span><span class='op'>::</span><span class='const'>Types</span><span class='op'>::</span><span class='const'>TypeFactory</span><span class='period'>.</span><span class='id identifier rubyid_variant'>variant</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_callables'>callables</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_callables'>callables</span><span class='period'>.</span><span class='id identifier rubyid_pop'>pop</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

    <div id="footer">
  Generated on Thu Jun 12 11:08:18 2014 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.8.7.4 (ruby-2.0.0).
</div>

  </body>
</html>